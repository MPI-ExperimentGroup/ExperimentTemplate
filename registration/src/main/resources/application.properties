# when behind a proxy the external URL and external context path needs to be defined for Thymeleaf
# nl.mpi.tg.eg.frinex.externalAdminUrl=@experiment.destinationServerUrl@/@experiment.configuration.name@-admin/

spring.jpa.show-sql=false
spring.jmx.enabled=false
spring.jmx.unique-names=false
# server.tomcat.redirect-context-root=false
# server.forward-headers-strategy=FRAMEWORK
# spring boot 1.4
#spring.http.multipart.max-file-size=10MB
#spring.http.multipart.max-request-size=10MB
# spring boot 2.x
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB
# (/actuator/health/liveness) and readiness (/actuator/health/readiness)
#management.health.probes.enabled=true
spring.jpa.database=POSTGRESQL
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=update
#spring.jpa.hibernate.ddl-auto=validate
#spring.jpa.hibernate.ddl-auto=create-drop
#spring.jpa.hibernate.ddl-auto=none

# Only expose health and metrics endpoints
management.endpoints.web.exposure.include=health,metrics
# Only show necessary health details to external monitors
management.endpoint.health.show-details=always
management.health.diskspace.enabled=false
management.health.db.enabled=true
management.health.mail.enabled=false
management.health.redis.enabled=false

# Only collect essential metrics to reduce overhead
management.metrics.enable.all=false
management.metrics.enable.jvm.memory=true
management.metrics.enable.jvm.gc=true
management.metrics.enable.jetty.threads=true
management.metrics.enable.hikari.connections=true

# Reduce actuator request payload
management.endpoint.health.cache.time-to-live=5s
management.endpoint.metrics.cache.time-to-live=5s

# setting the async timeout for the ZIP download of media files
spring.mvc.async.request-timeout=180000
spring.jpa.properties.hibernate.cache.use_second_level_cache=true
spring.jpa.properties.hibernate.cache.use_query_cache=true
spring.jpa.properties.hibernate.cache.region.factory_class=org.hibernate.cache.ehcache.EhCacheRegionFactory
spring.database.driverClassName=org.postgresql.Driver
spring.datasource.url=jdbc:postgresql://@experiment.configuration.db.host@/frinex_@experiment.configuration.name@_db
spring.datasource.username=frinex_@experiment.configuration.name@_user
spring.datasource.tomcat.max-active=5
spring.datasource.tomcat.max-idle=2
spring.datasource.tomcat.min-idle=1
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.ldap.LdapAutoConfiguration,org.springframework.boot.actuate.autoconfigure.ldap.LdapHealthContributorAutoConfiguration
nl.mpi.tg.eg.frinex.experiment.name=@experiment.configuration.name@
nl.mpi.tg.eg.frinex.ldap.adUrl=ldaps://ldap.example.com
nl.mpi.tg.eg.frinex.ldap.adDomain=example.com
nl.mpi.tg.eg.frinex.admin.securityGroup=@experiment.configuration.securityGroup@
nl.mpi.tg.eg.frinex.admin.user=@experiment.configuration.name@
spring.datasource.password=@experiment.configuration.db.password@
nl.mpi.tg.eg.frinex.admin.password=@experiment.configuration.admin.password@
nl.mpi.tg.eg.frinex.admin.allowDelete=@experiment.configuration.admin.allowDelete@
# informReadyUrl and requestScalingUrl are now passed as parameters when the service starts
# nl.mpi.tg.eg.frinex.informReadyUrl=@experiment.configuration.informReadyUrl@
# nl.mpi.tg.eg.frinex.requestScalingUrl=@experiment.configuration.requestScalingUrl@

#CREATE USER frinex_@experiment.configuration.name@_user WITH PASSWORD '@experiment.configuration.db.password@';
#CREATE DATABASE frinex_@experiment.configuration.name@_db;
#GRANT ALL PRIVILEGES ON DATABASE frinex_@experiment.configuration.name@_db to frinex_@experiment.configuration.name@_user;
#\q
